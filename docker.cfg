[buildout]
extends =
    prod.cfg
    versions-migration.cfg

parts -= facts

parts +=
    instance-migration

[instance]
relative-paths = true
zeo-client = true
zeo-address = $(ZEO_HOST):$(ZEO_PORT)
shared-blob = off
zope-conf-additional =
  %define ZEOADDRESS ${zeoserver:zeo-address}
  %define ZEOINSTANCE ${buildout:directory}/parts/zeoserver/var
  %define BLOBSTORAGE ${buildout:directory}/var/blobstorage
event-log-custom =
    <syslog>
        address logs.imio.be:5544
        facility local3
        format %(asctime)s $(HOSTNAME_HOST) zope[%(process)s]: $(PROJECT_ID) ${:_buildout_section_name_} [%(levelname)s] %(name)s | %(message)s
	dateformat %b %d %H:%M:%S
        level info
    </syslog>
    <logfile>
        path ${buildout:directory}/var/log/${:_buildout_section_name_}.log
        level INFO
    </logfile>

[instance-debug]
zeo-address = $(ZEO_HOST):$(ZEO_PORT)
shared-blob = off


[instance-migration]
<= instance
http-address = 8088
user = admin:admin
debug-mode = on
verbose-security = on

eggs =
    ${instance:eggs}
    Products.directory
    quintagroup.transmogrifier
    wildcard.fixpersistentutilities
    cpskin.migration
    communesplone.iconified_document_actions
    kss.core
    acptheme.cpskin3

zcml =
    ${instance:zcml}
    quintagroup.transmogrifier
    wildcard.fixpersistentutilities
    cpskin.migration
    communesplone.iconified_document_actions
    kss.core
    acptheme.cpskin3

[svnproducts]
urls +=
    http://svn.communesplone.org/svn/communesplone/BottinAssociation/trunk BottinAssociation
    http://svn.communesplone.org/svn/communesplone/BottinCommercant/trunk BottinCommercant
    http://svn.communesplone.org/svn/communesplone/contacts/tags/0.6 contacts



[download]
recipe = hexagonit.recipe.download
url = http://files.imio.be/buildout-cache.tar.bz2

[install]
recipe = collective.recipe.cmd
on_install = true
cmds = tar jxvf ${download:location}/buildout-cache.tar.bz2 1>/dev/null